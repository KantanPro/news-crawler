# News Crawler

指定されたニュースソースから自動的に記事を取得し、WordPressサイトに投稿として追加するプラグイン。YouTube動画のクロール機能も含む。

## 概要

News Crawlerは、WordPressサイトに自動的にコンテンツを追加するための包括的なプラグインです。ニュースソースからの記事取得、YouTube動画のクロール、アイキャッチ画像の自動生成、AI要約の生成など、コンテンツ管理を自動化します。

## 主な機能

- **ニュースソースからの自動記事取得**: RSSフィードやその他のAPI対応サービスから記事を自動取得
- **YouTube動画の自動クロール**: YouTubeチャンネルから動画を自動取得し、埋め込み投稿を作成
- **アイキャッチ画像の自動生成**: AIを活用したアイキャッチ画像の自動生成
- **AI要約の自動生成**: OpenAI APIを使用した記事の自動要約
- **ジャンル別設定管理**: 複数のジャンルに対応した設定管理システム
- **YouTube APIのクォータ制限対応**: API使用量の監視と制限への適切な対応

## 新機能（v1.9.17）

- **ニュースソースの並び替え改善**: ニュースソースを最新の記事を優先するように並び替える機能を追加し、より関連性の高い記事を優先的に取得
- **デバッグ情報の強化**: デバッグ情報を強化し、より詳細なログを記録することで、問題の特定と解決を効率化
- **日付取得ロジックの改善**: 記事の日付取得ロジックを改善し、pubDateフィールドを追加することで、より正確な記事の時系列管理を実現

## 新機能（v1.9.16）

- **cron設定の自動化**: 自動投稿のcron設定を確実に実行するためのフックを追加し、cronが未設定の場合に自動投稿の設定を行う機能を実装
- **エラーログの改善**: エラーログに設定実行のメッセージを追加し、より詳細な情報を提供
- **デバッグ情報の強化**: ニュースクロール機能とYouTubeクロール機能において、デバッグ情報を追加し、期間制限チェックの詳細なログを記録するように改善
- **AJAXアクションの追加**: ジャンル設定に新しいAJAXアクションを追加し、より柔軟な設定管理を実現

## 新機能（v1.9.15）

- **設定項目の名称変更**: ニュースクロール機能の設定項目「最大記事数」を「一度に引用する記事数」に名称変更し、デフォルト値を10から1に変更
- **ジャンル名のタイトル追加**: ジャンル名を取得しタイトルの先頭に追加する機能を実装し、投稿タイトルがより関連性のあるものに
- **SEOタイトル自動生成**: SEOタイトル自動生成機能を追加し、管理画面に設定オプションを実装
- **要約の配置改善**: 要約を最初のH2タグの上に挿入する機能を追加し、まとめを投稿内容の末尾に追加するように変更
- **期間制限機能**: コンテンツ取得に関する期間制限機能を追加し、古い記事や動画をスキップするロジックを実装

## 新機能（v1.9.14）

- **ニュースクロール機能の出力改善**: ニュースクロール機能の出力から引用ブロックを削除し、記事の見出し表示を簡素化

## 新機能（v1.9.13）

- **Xシェア機能の削除**: Xシェア機能を削除し、プラグインの安定性を向上

## 新機能（v1.9.12）

- **OGP設定でX投稿時の説明文制御機能**: 説明文の長さと内容を制御可能にし、より適切なX投稿を実現
- **管理メニュー構造の改善**: OGP設定をNews Crawlerメニューのサブメニューに移動し、より整理された管理画面を実現

## 新機能（v1.9.11）

- **テンプレート生成機能の削除**: AI画像生成をデフォルトに設定し、より安定した画像生成を実現
- **設定項目の簡素化**: 設定項目を簡素化し、デフォルト値を使用するように変更
- **使いやすい設定画面**: より直感的で使いやすい設定画面を実現

## 新機能（v1.9.10）

- **バージョン1.9.10に更新**: XPoster依存から独立したNews Crawlerとしての機能を強化
- **メタデータの設定処理改善**: より安定したメタデータ設定を実現
- **フックとコメントの更新**: 関連するフックやコメントを最新化

## 新機能（v1.9.9）

- **XPoster連携の強化**: 個別投稿作成時のシェア機能を修正し、より安定した連携を実現
- **投稿作成時の連携改善**: 投稿作成時のXPoster連携の安定性を向上
- **シェア機能の動作改善**: 個別投稿作成時のシェア機能の動作を改善

## 新機能（v1.9.8）

- **バージョン1.9.8リリース**: 安定性とパフォーマンスの向上
- **コードの最適化**: バグ修正とパフォーマンス改善
- **安定性の向上**: より安定した動作を実現

## 新機能（v1.9.7）

- **XPoster完全連携**: XPosterと同じ投稿監視フックを実装し、新規投稿が確実に認識されるように改善
- **投稿メタデータの強化**: XPoster用のメタデータを直接設定し、連携を確実化
- **遅延実行の最適化**: 投稿ステータス変更の遅延時間を延長し、XPosterの認識を確実化
- **メタデータ再設定機能**: 投稿作成後にXPoster用メタデータを再設定する機能を追加

## 新機能（v1.9.6）

- **XPoster連携機能**: 投稿ステータス変更フックを実装し、XPosterとの連携を強化
- **投稿ステータス管理の改善**: 投稿を最初に下書きとして作成する処理を実装
- **遅延実行機能**: 投稿ステータス変更を遅延実行する機能を追加
- **メタデータ更新の強化**: 関連メタデータを更新する処理を強化

## 新機能（v1.9.5）

- **要約をexcerptに設定するオプション**: 投稿更新時に要約をexcerptに設定する処理を実装
- **ログ出力の強化**: より詳細なログ情報を提供
- **最近の成功投稿表示**: 最近の成功投稿を一覧表示する機能を追加

## 新機能（v1.9.4）

- **OGP管理機能**: アイキャッチ画像の更新時にOGPマネージャーに通知する処理を実装
- **投稿設定の改善**: サブメニュー名の変更とCronスケジュールリセット機能を追加

## 新機能（v1.9.3）

- **YouTube APIのクォータ制限対応**: APIクォータの使用状況を監視し、制限に達した際の適切な処理を実装

## インストール

1. プラグインファイルを `/wp-content/plugins/news-crawler/` ディレクトリにアップロード
2. WordPressの管理画面でプラグインを有効化
3. 設定画面で必要なAPIキーを設定

## 必要なAPIキー

- **YouTube Data API v3**: YouTube動画の取得に必要
- **OpenAI API**: AI要約とアイキャッチ画像生成に必要
- **X API**: Xへの自動投稿に必要

## 使用方法

### 基本設定
1. 管理画面の「News Crawler」メニューから設定画面にアクセス
2. 必要なAPIキーを設定
3. ジャンル別の設定を行う

### ニュースクロール
1. ジャンル設定でニュースソースを指定
2. キーワードやフィルタリング条件を設定
3. 手動実行または自動実行を設定

### YouTube動画クロール
1. YouTube設定でチャンネルIDを指定
2. 取得する動画の条件を設定
3. 手動実行または自動実行を設定

## 設定項目

### ジャンル設定
- ニュースソースのURL
- キーワードフィルタリング
- 投稿カテゴリー
- タグ設定

### YouTube設定
- チャンネルID
- 動画の取得条件
- 投稿の形式設定

### SNS設定
- X API設定
- 自動投稿の条件
- 投稿テンプレート

## トラブルシューティング

### よくある問題

**YouTube APIのクォータ制限エラー**
- v1.9.0から改善されたクォータ制限対応により、適切な処理が行われます
- 設定画面でAPI使用量を確認できます

**X自動投稿が動作しない**
- X APIキーが正しく設定されているか確認
- API権限が適切に設定されているか確認

**XPosterで新規投稿が認識されない**
- v1.9.7から実装されたXPoster完全連携により、新規投稿が確実に認識されるようになりました
- 投稿作成時にXPoster用のメタデータが自動設定されます
- 投稿ステータス変更の遅延実行により、XPosterの認識を確実化しています

**アイキャッチ画像が生成されない**
- OpenAI APIキーが正しく設定されているか確認
- API使用量の制限に達していないか確認

## 更新履歴

### v1.9.17 (2025年8月29日)
- ニュースソースを最新の記事を優先するように並び替える機能を追加
- デバッグ情報を強化し、より詳細なログを記録
- 記事の日付取得ロジックを改善し、pubDateフィールドを追加

### v1.9.16 (2025年8月29日)
- 自動投稿のcron設定を確実に実行するためのフックを追加し、cronが未設定の場合に自動投稿の設定を行う機能を実装
- エラーログに設定実行のメッセージを追加
- ニュースクロール機能とYouTubeクロール機能において、デバッグ情報を追加し、期間制限チェックの詳細なログを記録するように改善
- ジャンル設定に新しいAJAXアクションを追加

### v1.9.15 (2025年8月29日)
- ニュースクロール機能の設定項目「最大記事数」を「一度に引用する記事数」に名称変更し、デフォルト値を10から1に変更
- ジャンル名を取得しタイトルの先頭に追加する機能を実装
- SEOタイトル自動生成機能を追加し、管理画面に設定オプションを実装
- 要約を最初のH2タグの上に挿入する機能を追加し、まとめを投稿内容の末尾に追加するように変更
- コンテンツ取得に関する期間制限機能を追加し、古い記事や動画をスキップするロジックを実装

### v1.9.14 (2025年8月28日)
- ニュースクロール機能の出力から引用ブロックを削除し、記事の見出し表示を簡素化

### v1.9.13 (2025年8月28日)
- Xシェア機能を削除し、プラグインの安定性を向上

### v1.9.8 (2025年8月28日)
- バージョン1.9.8リリース
- 安定性とパフォーマンスの向上
- コードの最適化とバグ修正

### v1.9.6 (2025年8月28日)
- XPoster連携機能を追加
- 投稿ステータス変更フックを実装
- 投稿を最初に下書きとして作成する処理を実装
- 投稿ステータス変更を遅延実行する機能を追加
- 関連メタデータを更新する処理を強化

### v1.9.5 (2025年8月28日)
- 要約をexcerptに設定するオプションを追加
- 投稿更新時に要約をexcerptに設定する処理を実装
- ログ出力を強化
- 最近の成功投稿を表示する機能を追加

### v1.9.4 (2025年8月28日)
- OGP管理機能を追加
- アイキャッチ画像の更新時にOGPマネージャーに通知する処理を実装
- 投稿設定のサブメニュー名を変更
- Cronスケジュールリセット機能を追加

### v1.9.3 (2024年12月19日)
- YouTube APIのクォータ制限対応
- その他のバグ修正とパフォーマンス向上

### v1.8.0
- アイキャッチ画像生成機能を追加
- AI要約生成機能を追加
- ジャンル別設定管理を改善

### v1.7.0
- YouTubeクローラー機能を追加
- 管理画面のUIを改善

### v1.6.0
- 基本的なニュースクロール機能を実装
- 管理画面の基本構造を追加

## ライセンス

MIT License

## 作者

KantanPro - [GitHub](https://github.com/KantanPro)

## サポート

問題や質問がある場合は、GitHubのIssuesページで報告してください。
