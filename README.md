# News Crawler

指定されたニュースソースから自動的に記事を取得し、WordPressサイトに投稿として追加するプラグイン。YouTube動画のクロール機能も含む。

## 概要

News Crawlerは、設定したニュースソース（RSSフィードやニュースサイト）から自動的に記事を取得し、キーワードにマッチした記事を1つの投稿にまとめて作成するWordPressプラグインです。また、YouTubeチャンネルから動画を取得して動画の埋め込みと要約を含む投稿を作成する機能も提供します。

## 主な機能

### ジャンル別設定管理機能（NEW!）
- **ジャンル別設定保存**: 複数のジャンル設定を保存・管理
- **統合管理画面**: ニュースとYouTube動画を1つの画面で管理
- **ワンクリック実行**: 保存した設定から直接投稿作成を実行
- **設定の再利用**: 一度設定したジャンルを繰り返し使用可能
- **基本設定の分離**: YouTube APIキーなど共通設定を別管理

### ニュースクロール機能
- **複数のニュースソース対応**: RSSフィードとHTMLページの両方に対応
- **キーワードベースのフィルタリング**: 設定したキーワードにマッチした記事のみを取得
- **重複記事の自動スキップ**: タイトルの類似性とURLの重複チェック
- **品質スコアによる評価**: 記事の品質を0.0〜1.0のスコアで評価
- **複数記事の統合**: 複数の記事を1つの投稿にまとめる機能
- **管理画面での制御**: 設定と手動実行が可能
- **統計情報の表示**: 投稿数やスキップ数などの統計を表示

### YouTube動画クロール機能
- **YouTubeチャンネル対応**: 指定したチャンネルから動画を自動取得
- **動画の埋め込み**: レスポンシブ対応の動画埋め込み
- **キーワードフィルタリング**: 動画タイトルと説明からキーワードマッチング
- **重複動画の自動スキップ**: 既に投稿済みの動画を自動スキップ
- **動画情報の表示**: 公開日、チャンネル名、動画時間、視聴回数などを表示
- **複数動画の統合**: 複数の動画を1つの投稿にまとめる機能

## 対応ソース

### ニュースソース
- RSSフィード
- ニュースサイトのHTMLページ
- 主要メディアサイト（NHK、朝日新聞、読売新聞など）

### YouTubeソース
- YouTubeチャンネル（チャンネルID指定）
- YouTube Data API v3対応
- 動画の自動取得と埋め込み

## 品質管理機能

- タイトル長のチェック（5〜150文字）
- 本文長のチェック（50文字以上）
- 画像の有無
- 日付情報の有無
- ソース情報の有無

## インストール方法

1. プラグインファイルを `/wp-content/plugins/news-crawler/` ディレクトリにアップロード
2. WordPressの管理画面でプラグインを有効化
3. 設定 > News Crawler から設定を行う
4. ニュースソースとキーワードを設定
5. 「投稿を作成」ボタンで手動実行

## 設定項目

### ニュースクロール設定
- **最大記事数**: 取得する記事の最大数（1-50件）
- **キーワード設定**: 1行に1キーワードを入力
- **ニュースソース**: 1行に1URLを入力（RSSフィードまたはニュースサイト）
- **投稿カテゴリー**: 投稿するカテゴリー名
- **投稿ステータス**: 下書き、公開、非公開、承認待ちから選択

### YouTube設定
- **YouTube API キー**: YouTube Data API v3のAPIキー
- **YouTubeチャンネルID**: 1行に1チャンネルIDを入力
- **最大動画数**: 取得する動画の最大数（1-20件）
- **キーワード設定**: 1行に1キーワードを入力
- **投稿カテゴリー**: 投稿するカテゴリー名
- **投稿ステータス**: 下書き、公開、非公開、承認待ちから選択
- **動画埋め込みタイプ**: レスポンシブ、クラシック、ミニマルから選択

## 使用方法

### 基本設定
1. WordPress管理画面で「News Crawler」→「基本設定」にアクセス
2. YouTube APIキーを設定（YouTube機能を使用する場合）
3. デフォルト投稿者を選択
4. 設定を保存

### ジャンル設定の作成
1. 「News Crawler」→「ジャンル設定」にアクセス
2. ジャンル名を入力
3. コンテンツタイプ（ニュース記事またはYouTube動画）を選択
4. キーワードを設定（必須）
5. 各コンテンツタイプに応じた詳細設定を行う
6. 投稿カテゴリーとステータスを設定
7. 「設定を保存」をクリック

### 投稿の作成
1. 保存済みジャンル設定リストから対象のジャンルを選択
2. 「投稿を作成」ボタンをクリック
3. 自動的にコンテンツが取得・解析され、投稿が作成される
4. 実行結果が画面に表示される

### 設定の編集
1. ジャンル設定リストから「編集」ボタンをクリック
2. 設定フォームに既存の設定が読み込まれる
3. 必要な変更を行い「設定を保存」をクリック

## システム要件

- WordPress 5.0以上
- PHP 7.4以上

## 必要なAPIキー

### YouTube Data API v3
YouTube動画クロール機能を使用するには、YouTube Data API v3のAPIキーが必要です。

1. [Google Cloud Console](https://console.cloud.google.com/)にアクセス
2. プロジェクトを作成または選択
3. YouTube Data API v3を有効化
4. APIキーを作成
5. プラグインの設定画面でAPIキーを入力

**注意**: APIキーは公開されないよう適切に管理してください。

## ライセンス

MIT License

## セキュリティ

### APIキーの管理
- OpenAI APIキーは基本設定画面から安全に設定・管理されます
- APIキーのハードコーディングは禁止されており、セキュリティベストプラクティスに従っています
- 設定されたAPIキーは暗号化されてデータベースに保存されます

### データ保護
- 外部APIとの通信は適切な認証を使用
- ユーザーデータの適切な検証とサニタイゼーション
- WordPressのセキュリティ標準に準拠

## 変更履歴

### Version 1.5.1 (2025年8月25日)
- **セキュリティ強化**: OpenAI APIキーの手動設定機能を廃止
- **コードクリーンアップ**: ハードコードされたAPIキーを含むテストファイルを削除
- **設定画面の整理**: 基本設定画面から不要な手動設定部分を削除
- **プロジェクト構造の改善**: テスト・デバッグファイルを整理

### Version 1.5.0 (2025年8月25日)
- **設定の統合とリスト保存機能を追加**: 複数の設定を効率的に管理
- **ジャンル別設定管理機能を追加**: 複数のジャンル設定を保存・管理可能
- **統合管理画面**: ニュースとYouTube動画を1つの画面で管理
- **基本設定の分離**: YouTube APIキーなど共通設定を別メニューに移動
- **ワンクリック実行**: 保存した設定から直接投稿作成を実行
- **設定の再利用**: 一度設定したジャンルを繰り返し使用可能
- **ユーザビリティの大幅改善**: より直感的で効率的な操作が可能

### Version 1.4.0 (2025年8月24日)
- **設定の統合とリスト保存機能を追加**: 複数の設定を効率的に管理
- **ジャンル別設定管理機能を追加**: 複数のジャンル設定を保存・管理可能
- **統合管理画面**: ニュースとYouTube動画を1つの画面で管理
- **基本設定の分離**: YouTube APIキーなど共通設定を別メニューに移動
- **ワンクリック実行**: 保存した設定から直接投稿作成を実行
- **設定の再利用**: 一度設定したジャンルを繰り返し使用可能
- **ユーザビリティの大幅改善**: より直感的で効率的な操作が可能

### Version 1.3.0 (2025年8月24日)
- ファーストテイク

### Version 1.2.0 (2025年1月)
- YouTube動画クロール機能を追加
- YouTube Data API v3対応
- 動画の埋め込みと要約機能
- 設定画面にYouTubeメニューを追加

### Version 1.1.0 (2025年8月23日)
- ファーストテイク

## 作者

KantanPro - [GitHub](https://github.com/KantanPro)

## サポート

問題や質問がある場合は、GitHubのIssuesページでお知らせください。
